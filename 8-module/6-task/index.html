<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>–ë–∞–Ω–≥–∫–æ–∫ –≠–∫—Å–ø—Ä–µ—Å—Å: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –±–ª—é–¥</title>

  <link rel="stylesheet" href="index.css"/>
  <link rel="stylesheet" href="../../6-module/2-task/index.css">
  <link rel="stylesheet" href="../../assets/styles/common.css"/>
</head>

<style>
  body {
    color: var(--text-color);
    line-height: 1.1;
  }

  .controls {
    padding: 20px;
    margin-bottom: 20px;
    border: 2px solid var(--color-black-light);
    background: var(--color-black-dark);
    border-radius: 8px;
    color: var(--color-grey);
  }

  .controls__title {
    margin: 0 auto 20px;
    text-align: center;
    font-size: 1.3em;
    font-weight: bold;
  }

  .controls__row {
    margin: 15px 0;
  }

  .controls__row label {
    display: flex;
    align-items: center;
    font-size: 16px;
    cursor: pointer;
    margin-bottom: 10px;
  }

  .controls__row input[type="checkbox"] {
    margin-right: 10px;
    transform: scale(1.2);
  }

  .controls__row select {
    padding: 8px 12px;
    border: 2px solid #ddd;
    border-radius: 4px;
    font-size: 16px;
    background: white;
  }

  .controls__row select:focus {
    border-color: var(--color-yellow);
    outline: none;
  }

  .clear-btn {
    margin-top: 20px;
    padding: 10px 14px;
    background-color: oklch(65.6% 0.241 354.308);
    color: rgb(255, 255, 255);
    border: 0 solid;
    border-radius: 6px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.25s ease-in 0s;
  }

  .clear-btn:hover {
    background-color: oklch(0.599 0.24 356.935);
  }

  .results-info {
    display: flex;
    flex-direction: column;
    margin-top: 15px;
    padding: 10px;
    background: oklch(0.962 0.044 156.742996);
    border-radius: 6px;
    font-size: 16px;
    font-weight: 600;
    color: oklch(0.527 0.154 150.069);
  }
</style>

<body>
<div class="container controls">
  <div class="controls__row">
    <h3 class="controls__title">üçΩ&nbsp;–§–∏–ª—å—Ç—Ä—ã –¥–ª—è –±–ª—é–¥</h3>
  </div>

  <div class="controls__row">
    <label for="category-filter">üìÇ&nbsp;–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
    <select name="category" id="category-filter">
      <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
      <option value="salads">ü•ó&nbsp;–°–∞–ª–∞—Ç—ã</option>
      <option value="soups">üçú&nbsp;–°—É–ø—ã</option>
      <option value="chicken-dishes">üçó&nbsp;–ë–ª—é–¥–∞ –∏–∑ –∫—É—Ä–∏—Ü—ã</option>
      <option value="beef-dishes">ü•©&nbsp;–ë–ª—é–¥–∞ –∏–∑ –≥–æ–≤—è–¥–∏–Ω—ã</option>
      <option value="seafood-dishes">ü¶ê&nbsp;–ú–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç—ã</option>
      <option value="vegetable-dishes">ü•¨&nbsp;–û–≤–æ—â–Ω—ã–µ –±–ª—é–¥–∞</option>
      <option value="bits-and-bites">ü•ü&nbsp;–ó–∞–∫—É—Å–∫–∏</option>
      <option value="on-the-side">üçö&nbsp;–ì–∞—Ä–Ω–∏—Ä—ã</option>
    </select>
  </div>

  <div class="controls__row">
    <label for="spiciness-filter">üå∂Ô∏è&nbsp;–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –æ—Å—Ç—Ä–æ—Ç–∞:</label>
    <select name="spiciness" id="spiciness-filter">
      <option value="">–õ—é–±–∞—è –æ—Å—Ç—Ä–æ—Ç–∞</option>
      <option value="0">0 ‚Äî –°–æ–≤—Å–µ–º –Ω–µ –æ—Å—Ç—Ä–æ–µ</option>
      <option value="1">1 ‚Äî –°–ª–µ–≥–∫–∞ –æ—Å—Ç—Ä–æ–µ</option>
      <option value="2">2 ‚Äî –£–º–µ—Ä–µ–Ω–Ω–æ –æ—Å—Ç—Ä–æ–µ</option>
      <option value="3">3 ‚Äî –û—Å—Ç—Ä–æ–µ</option>
      <option value="4">4 ‚Äî –û—á–µ–Ω—å –æ—Å—Ç—Ä–æ–µ</option>
    </select>
  </div>

  <div class="controls__row">
    <label for="vegetarian-only">
      <input type="checkbox" id="vegetarian-only">
      üå±&nbsp;–¢–æ–ª—å–∫–æ –≤–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–∏–µ –±–ª—é–¥–∞
    </label>
  </div>

  <div class="controls__row">
    <label for="exclude-nuts">
      <input type="checkbox" id="exclude-nuts">
      üö´ü•ú&nbsp;–ò—Å–∫–ª—é—á–∏—Ç—å –±–ª—é–¥–∞ —Å –æ—Ä–µ—Ö–∞–º–∏
    </label>
  </div>

  <button type="button" class="clear-btn" id="clear-all">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã</button>

  <div class="results-info" id="results-info">
    <div>–ü–æ–∫–∞–∑–∞–Ω–æ –±–ª—é–¥: <span id="visible-count">0</span></div>
    <div>–í—Å–µ–≥–æ –±–ª—é–¥: <span id="total-count">0</span></div>
  </div>
</div>

<div class="container" id="container"></div>

<script type="module">
  import ProductGrid from './product-grid.js';
  import products from './products.js';

  // –°–æ–∑–¥–∞–µ–º grid –±–ª—é–¥
  const productGrid = new ProductGrid(products);
  container.append(productGrid.elem);

  // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  const categoryFilter = document.getElementById('category-filter');
  const spicinessFilter = document.getElementById('spiciness-filter');
  const vegetarianOnlyCheckbox = document.getElementById('vegetarian-only');
  const excludeNutsCheckbox = document.getElementById('exclude-nuts');
  const clearAllButton = document.getElementById('clear-all');
  const visibleCount = document.getElementById('visible-count');
  const totalCount = document.getElementById('total-count');

  // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª—é–¥
  totalCount.textContent = products.length;

  // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
  function updateResultsInfo() {
    const count = productGrid.getVisibleProductsCount();
    visibleCount.textContent = String(count);

    // –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–ª—é–¥
    const resultsInfo = document.getElementById('results-info');
    if (count === 0) {
      resultsInfo.style.background = 'rgb(255 226 226)';
      resultsInfo.style.color = 'rgb(193 0 7)';
    } else if (count === products.length) {
      resultsInfo.style.background = 'rgb(220 252 231)';
      resultsInfo.style.color = 'rgb(0 130 54)';
    } else {
      resultsInfo.style.background = 'rgb(254 249 194)';
      resultsInfo.style.color = 'rgb(137 75 0)';
    }
  }

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–∏–ª—å—Ç—Ä–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  categoryFilter.addEventListener('change', (event) => {
    const category = event.target.value || undefined;
    productGrid.updateFilter({category});
    updateResultsInfo();
    console.log('–§–∏–ª—å—Ç—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:', category || '–≤—Å–µ');
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–∏–ª—å—Ç—Ä–∞ –ø–æ –æ—Å—Ç—Ä–æ—Ç–µ
  spicinessFilter.addEventListener('change', (event) => {
    const maxSpiciness = event.target.value ? parseInt(event.target.value) : undefined;
    productGrid.updateFilter({maxSpiciness});
    updateResultsInfo();
    console.log('–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –æ—Å—Ç—Ä–æ—Ç–∞:', maxSpiciness ?? '–ª—é–±–∞—è');
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —á–µ–∫–±–æ–∫—Å–∞ "—Ç–æ–ª—å–∫–æ –≤–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–∏–µ"
  vegetarianOnlyCheckbox.addEventListener('change', (event) => {
    const onlyVegetarian = event.target.checked || undefined;
    productGrid.updateFilter({onlyVegetarian});
    updateResultsInfo();
    console.log('–¢–æ–ª—å–∫–æ –≤–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–∏–µ:', onlyVegetarian || false);
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —á–µ–∫–±–æ–∫—Å–∞ "–∏—Å–∫–ª—é—á–∏—Ç—å –æ—Ä–µ—Ö–∏"
  excludeNutsCheckbox.addEventListener('change', (event) => {
    const excludeNuts = event.target.checked || undefined;
    productGrid.updateFilter({excludeNuts});
    updateResultsInfo();
    console.log('–ò—Å–∫–ª—é—á–∏—Ç—å –æ—Ä–µ—Ö–∏:', excludeNuts || false);
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ"
  clearAllButton.addEventListener('click', () => {
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ –∫–æ–Ω—Ç—Ä–æ–ª—ã
    categoryFilter.value = '';
    spicinessFilter.value = '';
    vegetarianOnlyCheckbox.checked = false;
    excludeNutsCheckbox.checked = false;

    // –û—á–∏—â–∞–µ–º —Ñ–∏–ª—å—Ç—Ä—ã –≤ ProductGrid
    productGrid.clearAllFilters();
    updateResultsInfo();
    console.log('–í—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã –æ—á–∏—â–µ–Ω—ã');
  });

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—á–µ—Ç—á–∏–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
  updateResultsInfo();
</script>
</body>

</html>
